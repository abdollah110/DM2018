import os
import json
from pprint import pprint
from array import array


# This comes from PlotDigitizer (I have digitized the fiqure 9 of EXO-17-003)
List=[
      
      [	1542.575	,	0.997578	],
      [	1542.5659	,	0.9961128	],
      [	1542.5479	,	0.9931824	],
      [	1542.5343	,	0.99098456	],
      [	1542.5253	,	0.98951936	],
      [	1541.0393	,	0.9873238	],
      [	1541.0303	,	0.9858586	],
      [	1536.586	,	0.9814697	],
      [	1536.577	,	0.9800045	],
      [	1536.577	,	0.9800045	],
      [	1533.6097	,	0.97634596	],
      [	1533.5962	,	0.97414815	],
      [	1532.1102	,	0.97195256	],
      [	1530.6288	,	0.9704896	],
      [	1526.1846	,	0.96610075	],
      [	1526.162	,	0.9624377	],
      [	1526.162	,	0.9624377	],
      [	1526.1484	,	0.9602399	],
      [	1524.6625	,	0.95804435	],
      [	1524.6444	,	0.9551139	],
      [	1521.6816	,	0.95218796	],
      [	1521.6726	,	0.95072275	],
      [	1520.1912	,	0.9492598	],
      [	1520.1776	,	0.947062	],
      [	1520.1595	,	0.94413155	],
      [	1520.1505	,	0.94266635	],
      [	1517.1877	,	0.9397404	],
      [	1515.6973	,	0.9368123	],
      [	1512.721	,	0.93168855	],
      [	1511.2305	,	0.92876035	],
      [	1511.2214	,	0.92729515	],
      [	1509.7355	,	0.92509955	],
      [	1509.7174	,	0.92216915	],
      [	1509.6948	,	0.91850615	],
      [	1509.6813	,	0.91630834	],
      [	1509.6722	,	0.91484314	],
      [	1509.6587	,	0.9126453	],
      [	1508.1729	,	0.91044974	],
      [	1505.2009	,	0.9060586	],
      [	1505.1829	,	0.9031282	],
      [	1503.6969	,	0.9009326	],
      [	1499.2527	,	0.89654374	],
      [	1497.7622	,	0.89361554	],
      [	1497.7487	,	0.89141774	],
      [	1497.7396	,	0.88995254	],
      [	1496.2448	,	0.88629174	],
      [	1496.2222	,	0.88262874	],
      [	1494.7407	,	0.88116574	],
      [	1491.787	,	0.8797051	],
      [	1491.7689	,	0.8767746	],
      [	1490.283	,	0.8745791	],
      [	1490.2604	,	0.870916	],
      [	1488.7834	,	0.8701857	],
      [	1487.302	,	0.86872274	],
      [	1485.8162	,	0.86652714	],
      [	1485.7981	,	0.86359674	],
      [	1482.8352	,	0.8606708	],
      [	1482.8217	,	0.858473	],
      [	1482.7991	,	0.85480994	],
      [	1482.7946	,	0.85407734	],
      [	1482.781	,	0.85187954	],
      [	1481.2906	,	0.8489514	],
      [	1479.8137	,	0.848221	],
      [	1476.8508	,	0.8452951	],
      [	1476.8373	,	0.84309727	],
      [	1476.8282	,	0.84163207	],
      [	1473.8745	,	0.84017134	],
      [	1473.861	,	0.83797354	],
      [	1473.8429	,	0.83504313	],
      [	1472.3569	,	0.83284754	],
      [	1470.871	,	0.830652	],
      [	1469.3942	,	0.8299216	],
      [	1469.3896	,	0.829189	],
      [	1469.3806	,	0.8277238	],
      [	1466.4222	,	0.82553047	],
      [	1466.3997	,	0.82186747	],
      [	1463.4369	,	0.81894153	],
      [	1463.4233	,	0.81674373	],
      [	1463.4098	,	0.8145459	],
      [	1463.3872	,	0.81088287	],
      [	1461.8922	,	0.8072221	],
      [	1460.4062	,	0.80502653	],
      [	1460.3882	,	0.8020961	],
      [	1458.9023	,	0.79990053	],
      [	1458.8888	,	0.7977027	],
      [	1457.4028	,	0.7955072	],
      [	1455.9214	,	0.7940442	],
      [	1454.4309	,	0.79111606	],
      [	1452.9451	,	0.78892046	],
      [	1449.9867	,	0.78672713	],
      [	1449.9867	,	0.78672713	],
      [	1449.9777	,	0.7852619	],
      [	1449.9596	,	0.7823315	],
      [	1447.0013	,	0.7801382	],
      [	1446.9788	,	0.7764752	],
      [	1445.4973	,	0.7750122	],
      [	1445.4973	,	0.7750122	],
      [	1445.4928	,	0.7742796	],
      [	1445.4838	,	0.7728144	],
      [	1445.4612	,	0.7691514	],
      [	1441.026	,	0.7662277	],
      [	1439.5446	,	0.7647647	],
      [	1439.5265	,	0.7618343	],
      [	1439.5175	,	0.7603691	],
      [	1439.5084	,	0.7589039	],
      [	1436.5547	,	0.7574432	],
      [	1435.0552	,	0.7530498	],
      [	1433.5692	,	0.75085425	],
      [	1430.6155	,	0.7493935	],
      [	1430.6019	,	0.7471957	],
      [	1430.5929	,	0.7457305	],
      [	1430.5839	,	0.7442653	],
      [	1430.5793	,	0.74353266	],
      [	1430.5658	,	0.74133486	],
      [	1427.6029	,	0.7384089	],
      [	1427.5894	,	0.7362111	],
      [	1426.09	,	0.7318177	],
      [	1424.604	,	0.7296222	],
      [	1424.5905	,	0.7274244	],
      [	1424.5724	,	0.7244939	],
      [	1420.1237	,	0.71937245	],
      [	1418.6332	,	0.71644425	],
      [	1417.1517	,	0.7149813	],
      [	1415.6614	,	0.7120531	],
      [	1415.6523	,	0.7105879	],
      [	1415.6388	,	0.7083901	],
      [	1414.1528	,	0.7061946	],
      [	1414.1483	,	0.705462	],
      [	1412.6624	,	0.7032664	],
      [	1411.163	,	0.698873	],
      [	1411.1449	,	0.6959426	],
      [	1408.191	,	0.69448185	],
      [	1408.1865	,	0.69374925	],
      [	1406.7006	,	0.6915537	],
      [	1406.687	,	0.6893559	],
      [	1405.1876	,	0.6849625	],
      [	1402.2247	,	0.6820366	],
      [	1400.7433	,	0.6805736	],
      [	1399.2665	,	0.67984325	],
      [	1399.2529	,	0.67764544	],
      [	1399.2439	,	0.67618024	],
      [	1399.2258	,	0.6732498	],
      [	1399.1987	,	0.6688542	],
      [	1396.2449	,	0.66739345	],
      [	1396.2313	,	0.66519564	],
      [	1393.2866	,	0.6652002	],
      [	1393.2776	,	0.6637349	],
      [	1388.8424	,	0.66081125	],
      [	1388.8289	,	0.65861344	],
      [	1388.8108	,	0.65568304	],
      [	1385.8524	,	0.6534897	],
      [	1385.8434	,	0.6520245	],
      [	1384.3484	,	0.6483637	],
      [	1382.8445	,	0.6432377	],
      [	1381.3585	,	0.6410422	],
      [	1379.8726	,	0.6388466	],
      [	1375.4329	,	0.6351903	],
      [	1375.4193	,	0.6329925	],
      [	1375.3922	,	0.62859684	],
      [	1369.4846	,	0.62567544	],
      [	1369.4801	,	0.62494284	],
      [	1370.939	,	0.6227428	],
      [	1367.9717	,	0.61908424	],
      [	1366.4812	,	0.6161561	],
      [	1367.931	,	0.6124908	],
      [	1362.028	,	0.610302	],
      [	1362.0144	,	0.60810417	],
      [	1360.5284	,	0.6059086	],
      [	1360.5104	,	0.60297817	],
      [	1359.0289	,	0.60151523	],
      [	1357.543	,	0.59931964	],
      [	1356.0616	,	0.5978567	],
      [	1356.0436	,	0.59492624	],
      [	1356.0345	,	0.59346104	],
      [	1353.0807	,	0.59200037	],
      [	1353.0626	,	0.5890699	],
      [	1351.5813	,	0.58760697	],
      [	1350.0953	,	0.58541137	],
      [	1350.0863	,	0.58394617	],
      [	1347.137	,	0.5832181	],
      [	1347.1189	,	0.58028764	],
      [	1345.6376	,	0.5788247	],
      [	1344.1516	,	0.5766291	],
      [	1342.6792	,	0.57663137	],
      [	1342.6611	,	0.57370096	],
      [	1339.6984	,	0.57077503	],
      [	1338.2034	,	0.56711423	],
      [	1336.7129	,	0.5641861	],
      [	1333.7546	,	0.56199276	],
      [	1330.7917	,	0.55906683	],
      [	1330.7737	,	0.5561364	],
      [	1329.2924	,	0.55467343	],
      [	1327.8109	,	0.5532105	],
      [	1327.7928	,	0.55028003	],
      [	1326.3114	,	0.5488171	],
      [	1326.3069	,	0.5480845	],
      [	1323.3441	,	0.54515857	],
      [	1321.8536	,	0.5422304	],
      [	1318.8773	,	0.53710663	],
      [	1318.8593	,	0.53417623	],
      ###
      [	1316.6658	,	0.52382815	],
      [	1313.714	,	0.52089775	],
      [	1310.7728	,	0.5194353	],
      [	1310.7728	,	0.5194353	],
      [	1310.7675	,	0.5187013	],
      [	1309.2861	,	0.5165022	],
      [	1307.7996	,	0.5135691	],
      [	1307.7888	,	0.51210123	],
      [	1304.8423	,	0.5099048	],
      [	1303.3557	,	0.5069717	],
      [	1303.3396	,	0.5047699	],
      [	1301.8529	,	0.50183684	],
      [	1298.8904	,	0.4974386	],
      [	1297.409	,	0.49523947	],
      [	1293.0082	,	0.4945136	],
      [	1292.9921	,	0.49231178	],
      [	1290.0457	,	0.49011534	],
      [	1290.0295	,	0.48791352	],
      [	1288.5536	,	0.48644835	],
      [	1285.6072	,	0.48425192	],
      [	1285.6072	,	0.48425192	],
      [	1285.6018	,	0.48351797	],
      [	1284.1097	,	0.47985095	],
      [	1284.099	,	0.4783831	],
      [	1282.6178	,	0.47618395	],
      [	1281.1472	,	0.4754527	],
      [	1281.1365	,	0.47398484	],
      [	1281.1204	,	0.471783	],
      [	1279.6444	,	0.4703178	],
      [	1275.2328	,	0.46812406	],
      [	1275.222	,	0.46665618	],
      [	1275.2113	,	0.46518832	],
      [	1273.7354	,	0.46372312	],
      [	1273.7247	,	0.46225524	],
      [	1272.2434	,	0.46005613	],
      [	1269.2969	,	0.4578597	],
      [	1269.2861	,	0.4563918	],
      [	1267.8049	,	0.45419267	],
      [	1266.3182	,	0.4512596	],
      [	1264.837	,	0.44906047	],
      [	1263.3557	,	0.44686136	],
      [	1260.4146	,	0.44539887	],
      [	1258.9226	,	0.44173184	],
      [	1257.4467	,	0.44026667	],
      [	1257.4413	,	0.43953273	],
      [	1255.96	,	0.43733358	],
      [	1254.4788	,	0.43513447	],
      [	1251.5322	,	0.432938	],
      [	1250.051	,	0.4307389	],
      [	1248.5536	,	0.42633796	],
      [	1245.6125	,	0.42487544	],
      [	1241.2062	,	0.42341563	],
      [	1236.7892	,	0.42048794	],
      [	1233.8535	,	0.4197594	],
      [	1230.9124	,	0.41829687	],
      [	1230.907	,	0.41756296	],
      [	1229.4419	,	0.41756564	],
      [	1223.5651	,	0.41537458	],
      [	1220.6132	,	0.4124442	],
      [	1217.6775	,	0.41171563	],
      [	1216.1962	,	0.4095165	],
      [	1213.2657	,	0.40952188	],
      [	1210.3301	,	0.40879333	],
      [	1207.3835	,	0.40659687	],
      [	1205.9131	,	0.40586564	],
      [	1202.9719	,	0.40440312	],
      [	1200.0255	,	0.4022067	],
      [	1198.5442	,	0.40000758	],
      [	1197.063	,	0.39780843	],
      [	1194.1111	,	0.39487806	],
      [	1194.1003	,	0.39341018	],
      [	1194.095	,	0.39267623	],
      [	1194.0789	,	0.3904744	],
      [	1191.1324	,	0.38827798	],
      [	1189.6565	,	0.3868128	],
      [	1188.1859	,	0.38608155	],
      [	1186.7047	,	0.3838824	],
      [	1186.694	,	0.38241455	],
      [	1182.2877	,	0.3809547	],
      [	1182.277	,	0.37948686	],
      [	1182.2555	,	0.3765511	],
      [	1180.7849	,	0.37581983	],
      [	1179.2982	,	0.37288678	],
      [	1176.3518	,	0.37069035	],
      [	1174.8759	,	0.36922514	],
      [	1174.8705	,	0.3684912	],
      [	1173.3893	,	0.3662921	],
      [	1170.4481	,	0.36482957	],
      [	1170.4374	,	0.36336172	],
      [	1167.4963	,	0.3618992	],
      [	1167.4856	,	0.3604313	],
      [	1164.5444	,	0.35896882	],
      [	1165.9935	,	0.35676432	],
      [	1164.5231	,	0.35603306	],
      [	1164.5123	,	0.3545652	],
      [	1163.0364	,	0.3531	],
      [	1160.0952	,	0.3516375	],
      [	1158.6086	,	0.34870443	],
      [	1155.6729	,	0.34797588	],
      [	1155.6675	,	0.34724194	],
      [	1155.6567	,	0.34577405	],
      [	1152.7157	,	0.34431157	],
      [	1152.6942	,	0.3413758	],
      [	1151.2075	,	0.33844274	],
      [	1149.7263	,	0.3362436	],
      [	1149.7102	,	0.33404177	],
      [	1146.7744	,	0.33331323	],
      [	1146.769	,	0.33257928	],
      [	1145.2932	,	0.33111408	],
      [	1145.2878	,	0.33038017	],
      [	1140.8761	,	0.32818642	],
      [	1140.8708	,	0.32745248	],
      [	1137.919	,	0.32452208	],
      [	1136.4376	,	0.32232296	],
      [	1134.9457	,	0.31865597	],
      [	1133.4697	,	0.31719077	],
      [	1131.9991	,	0.3164595	],
      [	1131.9991	,	0.3164595	],
      [	1131.9884	,	0.31499165	],
      [	1131.9778	,	0.31352377	],
      [	1129.0366	,	0.31206125	],
      [	1127.566	,	0.31133002	],
      [	1127.5607	,	0.31059608	],
      [	1126.0741	,	0.307663	],
      [	1124.5928	,	0.30546388	],
      [	1121.6571	,	0.3047353	],
      [	1120.1758	,	0.3025362	],
      [	1120.1758	,	0.3025362	],
      [	1117.2292	,	0.30033976	],
      [	1117.2239	,	0.29960582	],
      [	1114.2775	,	0.2974094	],
      [	1112.7961	,	0.29521024	],
      [	1111.315	,	0.29301113	],
      [	1106.898	,	0.29008344	],
      [	1105.4166	,	0.2878843	],
      [	1102.4701	,	0.28568786	],
      [	1102.4595	,	0.28421998	],
      [	1100.9835	,	0.28275478	],
      [	1095.1013	,	0.2798298	],
      [	1092.1602	,	0.27836728	],
      [	1086.2833	,	0.2761762	],
      [	1084.8129	,	0.27544498	],
      [	1078.936	,	0.27325392	],
      [	1077.4547	,	0.27105477	],
      [	1071.5779	,	0.2688637	],
      [	1067.1716	,	0.2674039	],
      [	1067.1501	,	0.26446816	],
      [	1064.2197	,	0.26447353	],
      [	1062.7546	,	0.2644762	],
      [	1061.2733	,	0.2622771	],
      [	1058.3375	,	0.26154852	],
      [	1056.8671	,	0.2608173	],
      [	1052.4607	,	0.25935748	],
      [	1049.5197	,	0.25789496	],
      [	1046.5786	,	0.25643247	],
      [	1043.616	,	0.25203422	],
      [	1042.1348	,	0.24983509	],
      [	1039.1936	,	0.24837258	],
      [	1037.7123	,	0.24617346	],
      [	1036.2418	,	0.2454422	],
      [	1033.3007	,	0.2439797	],
      [	1031.8248	,	0.2425145	],
      [	1031.8195	,	0.24178058	],
      [	1031.7872	,	0.23737694	],
      [	1030.3328	,	0.23884751	],
      [	1028.8461	,	0.23591444	],
      [	1027.381	,	0.23591714	],
      [	1027.3702	,	0.23444925	],
      [	1025.905	,	0.23445193	],
      [	1022.95856	,	0.2322555	],
      [	1021.47723	,	0.23005638	],
      [	1018.53613	,	0.22859387	],
      [	1015.5951	,	0.22713137	],
      [	1012.6486	,	0.22493494	],
      [	1011.17804	,	0.22420368	],
      [	1009.6914	,	0.22127062	],
      [	1009.6699	,	0.21833485	],
      [	1006.73956	,	0.21834023	],
      [	1006.7288	,	0.21687236	],
      [	1003.7931	,	0.2161438	],
      [	999.3815	,	0.21395005	],
      [	996.4296	,	0.21101967	],
      [	990.5528	,	0.2088286	],
      [	989.07153	,	0.20662947	],
      [	984.6545	,	0.2037018	],
      [	983.1786	,	0.2022366	],
      [	978.77765	,	0.20151073	],
      [	974.38214	,	0.20151879	],
      [	972.9008	,	0.19931966	],
      [	969.9598	,	0.19785716	],
      [	967.0187	,	0.19639467	],
      [	964.0776	,	0.19493216	],
      [	962.607	,	0.1942009	],
      [	958.20074	,	0.1927411	],
      [	955.25964	,	0.19127859	],
      [	953.7783	,	0.18907946	],
      [	949.37744	,	0.1883536	],
      [	949.3613	,	0.18615177	],
      [	947.8962	,	0.18615447	],
      [	944.9604	,	0.1854259	],
      [	942.014	,	0.18322946	],
      [	937.60767	,	0.18176965	],
      [	939.0675	,	0.18103303	],
      [	934.6451	,	0.1773714	],
      [	931.69867	,	0.17517495	],
      [	928.7522	,	0.17297852	],
      [	928.7468	,	0.17224458	],
      [	924.3459	,	0.1715187	],
      [	924.33514	,	0.17005083	],
      [	921.3994	,	0.16932227	],
      [	921.378	,	0.16638651	],
      [	916.9824	,	0.16639458	],
      [	916.97705	,	0.16566063	],
      [	911.11096	,	0.16493745	],
      [	909.6297	,	0.16273832	],
      [	906.6886	,	0.16127582	],
      [	905.21265	,	0.15981063	],
      [	902.27155	,	0.15834813	],
      [	899.31976	,	0.15541776	],
      [	896.37866	,	0.15395525	],
      [	893.4322	,	0.15175882	],
      [	890.49646	,	0.15103026	],
      [	887.5446	,	0.14809987	],
      [	883.133	,	0.14590612	],
      [	878.7213	,	0.14371237	],
      [	877.2454	,	0.14224719	],
      [	874.3097	,	0.14151862	],
      [	872.8391	,	0.14078738	],
      [	868.43286	,	0.13932756	],
      [	868.4221	,	0.13785969	],
      [	866.95154	,	0.13712843	],
      [	864.0051	,	0.134932	],
      [	859.6042	,	0.13420612	],
      [	856.6631	,	0.13274361	],
      [	850.78625	,	0.13055256	],
      [	847.8398	,	0.12835611	],
      [	843.4228	,	0.12542842	],
      [	837.5621	,	0.12543918	],
      [	834.6102	,	0.1225088	],
      [	831.6745	,	0.12178024	],
      [	831.6745	,	0.12178024	],
      [	830.19855	,	0.12031505	],
      [	824.33246	,	0.11959186	],
      [	821.38605	,	0.11739542	],
      [	818.4503	,	0.11666686	],
      [	816.97437	,	0.115201674	],
      [	814.044	,	0.11520705	],
      [	809.64844	,	0.115215115	],
      [	809.6324	,	0.1130133	],
      [	806.69666	,	0.112284735	],
      [	803.7609	,	0.11155617	],
      [	800.81445	,	0.109359734	],
      [	796.4135	,	0.10863386	],
      [	792.00726	,	0.10717405	],
      [	786.1412	,	0.10645086	],
      [	783.2001	,	0.10498837	],
      [	781.7241	,	0.10352317	],
      [	780.2482	,	0.102057986	],
      [	778.783	,	0.102060676	],
      [	774.38214	,	0.1013348	],
      [	771.44104	,	0.0998723	],
      [	768.5107	,	0.09987768	],
      [	764.1044	,	0.09841786	],
      [	758.2168	,	0.09475893	],
      ]

MassXS=[
[16,1300,300,330],
[17,1300,325,385],
[18,1300,350,440],
[19,1300,425,495],
[20,1300,500,550],
[21,1300,550,605],
[22,1300,600,660],
[16,1300,300,330],
[17,1300,350,385],
[18,1300,400,440],
[19,1300,450,495],
[20,1300,500,550],
[21,1300,550,605],
[22,1300,600,660],
        
]



#BR=0.5*0.5*2  # 50% Branching ratio for visible and invisible
#BR=1  # 50% Branching ratio for visible and invisible


delta=0.1
#beta=0.5
beta=1.0
B0=0.1
#B0=0.5

NewX, NewY=array( 'd' ), array( 'd' )


for j in range(0,40):
    for i in range(0,50):
        
        
        DM_mass=j*10+300
        LQ_mass=i*20+800


        if DM_mass*2.1 > LQ_mass: continue

        tau=pow((DM_mass*1.0/LQ_mass),2)
        K=pow((1-delta*delta*tau),0.5)*pow((1-(2+delta)*(2+delta)*tau),1.5)
        BR_visible=beta*B0/(B0+(1-B0)*K)


        for yy in range(len(List)):
            if  abs((List[yy][0] -  LQ_mass)) < 10   and abs((List[yy][1] -  BR_visible)) < 0.02 :
                print "\n digiLQ=%f digiBR=%f   LQmass=%d  DMMass=%d BR=%f "%(List[yy][0], List[yy][1], LQ_mass, DM_mass, BR_visible)
                NewX.append(LQ_mass)
                NewY.append(DM_mass)


x=0
oo=0
for ar in range(len(NewX)):
    if x==NewX[ar]: continue
    print "xx[%d]= %d; yy[%d]= %d;" %(oo,NewX[ar],oo,NewY[ar] )
    oo+=1
    x=NewX[ar]


dm_value=0
counter=0
for ar in range(len(NewX)):
    
    if NewY[ar]%50==0:
        if dm_value==NewY[ar]: continue
        print "xx[%d]= %d; yy[%d]= %d;" %(counter,NewX[ar],counter,NewY[ar] )
        counter+=1
        dm_value=NewY[ar]





